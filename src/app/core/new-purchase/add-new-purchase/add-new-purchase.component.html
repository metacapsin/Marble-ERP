<style>
  .p-stepper .p-stepper-panels {
    background: #ffffff;
    padding: 0%;
    color: #4b5563;
  }
</style>
<div class="page-wrapper">
  <div class="content">
    <!-- Page Header -->
    <div class="page-header">
      <div class="row">
        <div class="col-sm-12">
          <ul class="breadcrumb">
            <li class="breadcrumb-item">
              <a [routerLink]="routes.adminDashboard">Dashboard </a>
            </li>
            <li class="breadcrumb-item">
              <i class="feather icon-chevron-right"></i>
            </li>
            <li class="breadcrumb-item active">Purchase List</li>
            <li class="breadcrumb-item">
              <i class="feather icon-chevron-right"></i>
            </li>
            <li class="breadcrumb-item active">Purchase Add</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="page-header invoices-page-header">
      <div class="row align-items-center">
        <div class="col">
          <ul class="breadcrumb invoices-breadcrumb">
            <li class="breadcrumb-item invoices-breadcrumb-item">
              <a [routerLink]="routes.listNewPurchase">
                <i class="fa fa-chevron-left"></i> Back to Purchase List
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <!-- /Page Header -->
    <div class="row">
      <div class="col-md-12">
        <div class="card invoices-add-card">
          <div class="card-body">
            <form [formGroup]="addNewPurchaseForm" (ngSubmit)="addNewPurchaseFormSubmit()">
              <p-stepper [linear]="true">
                <p-stepperPanel header="Purchase Information">
                  <ng-template pTemplate="content" let-nextCallback="nextCallback" let-index="index">
                    <div class="flex flex-column h-12rem">
                      <div
                        class="border-2 border-dashed surface-border border-round surface-ground flex-auto flex justify-content-center align-items-center font-medium">
                        <h3 class="mb-4">Purchase Information</h3>
                        <div class="row">
                          <div class="col-xl-6 col-md-6 col-sm-12 col-12">
                            <div class="form-group local-forms">
                              <label for="invoiceNumber">Invoice Number<span class="login-danger"></span></label>
                              <input type="text" class="form-control" placeholder="Enter Invoice Number"
                                formControlName="invoiceNumber" />
                              <span style="color: #97704f; font-size: 12px">Leave it blank to generate
                                automatically</span>
                            </div>
                          </div>
                          <div class="col-xl-6 col-md-6 col-sm-12 col-12">
                            <div class="form-group local-forms">
                              <label for="purchaseDate">Purchase Date<span class="login-danger">*</span></label>
                              <p-calendar [maxDate]="maxDate" dataType="string" appendTo="body" dateFormat="mm/dd/yy"
                                formControlName="purchaseDate" placeholder="mm/dd/yyyy"
                                [styleClass]="'col-12'"></p-calendar>
                              <div *ngIf="
                                  addNewPurchaseForm
                                    .get('purchaseDate')
                                    ?.hasError('required') &&
                                  addNewPurchaseForm.get('purchaseDate')
                                    ?.touched
                                ">
                                <span class="login-danger">Field is required.
                                </span>
                              </div>
                            </div>
                          </div>
                          <div class="col-xl-6 col-md-6 col-sm-12 col-12">
                            <div class="form-group local-forms">
                              <label for="supplier">Supplier Name<span class="login-danger">*</span></label>
                              <p-dropdown [style]="{ width: '100%' }" placeholder="--Select Supplier--"
                                [options]="SupplierLists" formControlName="supplier" optionLabel="name"
                                optionValue="_id" display="chip" [showClear]="true"></p-dropdown>

                              <div *ngIf="
                                  addNewPurchaseForm
                                    .get('supplier')
                                    ?.hasError('required') &&
                                  addNewPurchaseForm.get('supplier')?.touched
                                ">
                                <span class="login-danger">Field is required.
                                </span>
                              </div>
                            </div>
                          </div>
                          <div class="col-xl-6 col-md-6 col-sm-12 col-12">
                            <div class="form-group local-forms">
                              <label for="paidToSupplierPurchaseCost">Purchase Cost ( Paid to Supplier )</label>
                              <div class="input-group">
                                <div class="input-group-prepend">
                                  <span class="input-group-text">₹</span>
                                </div>
                                <input class="form-control" formControlName="paidToSupplierPurchaseCost" type="number"
                                  placeholder="Purchase Cost" />
                              </div>
                              <div *ngIf="
                                  addNewPurchaseForm
                                    .get('paidToSupplierPurchaseCost')
                                    ?.hasError('min') &&
                                  addNewPurchaseForm.get('paidToSupplierPurchaseCost')
                                    ?.touched
                                ">
                                <span class="login-danger">Input must be at least 0.
                                </span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="d-flex pt-4 justify-content-end">
                      <button class="btn btn-primary" (click)="nextStep(nextCallback)">
                        Next <i class="fa-solid fa-arrow-right"></i>
                      </button>
                    </div>
                  </ng-template>
                </p-stepperPanel>
                <p-stepperPanel header="{{lotTypeValue}} Information">
                  <ng-template pTemplate="content" let-prevCallback="prevCallback" let-nextCallback="nextCallback"
                    let-index="index">
                    <div class="row">
                      <div class="col-xl-6 col-md-6 col-sm-12 col-12">
                        <div class="form-group local-forms">
                          <label for="lotsNo">Type<span class="login-danger">*</span></label>
                          <p-dropdown [options]="lotsNoArray" [style]="{ width: '100%' }" styleClass="" appendTo="body"
                            optionLabel="name" optionValue="_id" placeholder="Type" [filter]="true" filterBy="name"
                            [showClear]="true" (onChange)="lotType($event.value)" formControlName="purchaseType">
                          </p-dropdown>
                          <div *ngIf="
                            addNewPurchaseForm
                              .get('lotsType')
                              ?.hasError('required') &&
                            addNewPurchaseForm.get('lotsType')?.touched
                          ">
                            <span class="login-danger">Field is required.
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div>
                      <app-add-lot *ngIf="lotTypeValue === 'Lot'" [transportationCharges]="transportationCharges"
                        (dataEmitter)="receiveData($event)" [otherCharges]="otherCharges"></app-add-lot>
                    </div>
                    <div class="card p-3" *ngIf="lotTypeValue === 'slab'">
                      <div class="row card-body">
                        <div class="col-12 col-md-4 col-xl-4">
                          <div class="form-group local-forms">
                            <label for="slabNo">Slab Number<span class="login-danger">*</span></label>
                            <input class="form-control" type="text" placeholder="Select slabs Number"
                              formControlName="slabNo" />
                            <div *ngIf="
                                addNewPurchaseForm.get('slabNo')?.hasError('required') &&
                                addNewPurchaseForm.get('slabNo')?.touched
                              ">
                              <span class="login-danger">Field is required.</span>
                            </div>
                            <div *ngIf="
                                addNewPurchaseForm.get('slabNo')?.hasError('pattern') &&
                                addNewPurchaseForm.get('slabNo')?.touched
                              ">
                              <span class="login-danger">Input must be at least 3 to 15</span>
                            </div>
                          </div>
                        </div>
                        <div class="col-12 col-md-4 col-xl-4">
                          <div class="form-group local-forms">
                            <label for="warehouseDetails">Warehouse<span class="login-danger">*</span></label>
                            <p-dropdown [options]="wareHousedataListsEditArray" styleClass="" appendTo="body"
                              optionLabel="name" optionValue="_id" placeholder="Select Warehouse"
                              formControlName="warehouseDetails" [style]="{ width: '100%' }" [filter]="true"
                              filterBy="name" [showClear]="true">
                            </p-dropdown>
                            <div *ngIf="
                                  addNewPurchaseForm
                                    .get('warehouseDetails')
                                    ?.hasError('required') &&
                                  addNewPurchaseForm.get('warehouseDetails')?.touched
                                ">
                              <span class="login-danger">Field is required.</span>
                            </div>
                          </div>
                        </div>
                        <div class="col-12 col-md-4 col-xl-4">
                          <div class="form-group local-forms">
                            <label for="category">Category <span class="login-danger">*</span></label>
                            <p-dropdown [options]="CategoryListsEditArray" styleClass="" appendTo="body"
                              optionLabel="name" optionValue="_id" placeholder="Select Category"
                              formControlName="categoryDetail" [style]="{ width: '100%' }" [filter]="true"
                              filterBy="name" [showClear]="true">
                            </p-dropdown>
                            <div *ngIf="
                                addNewPurchaseForm
                                  .get('categoryDetail')
                                  ?.hasError('required') &&
                                addNewPurchaseForm.get('categoryDetail')?.touched
                              ">
                              <span class="login-danger">Field is required.</span>
                            </div>
                          </div>
                        </div>

                        <div class="col-12 col-md-4 col-xl-4">
                          <div class="form-group local-forms">
                            <label for="subCategory">Sub Category <span class="login-danger">*</span></label>
                            <p-dropdown [options]="SubCategoryListsEditArray" styleClass="" appendTo="body"
                              optionValue="_id" placeholder="Select Sub Category" optionLabel="name"
                              formControlName="subCategoryDetail" [style]="{ width: '100%' }" [filter]="true"
                              filterBy="name" [showClear]="true">
                            </p-dropdown>
                            <div *ngIf="
                                addNewPurchaseForm
                                  .get('subCategoryDetail')
                                  ?.hasError('required') &&
                                addNewPurchaseForm.get('subCategoryDetail')?.touched
                              ">
                              <span class="login-danger">Field is required.</span>
                            </div>
                          </div>
                        </div>
                        <div class="col-12 col-md-4 col-xl-4">
                          <div class="form-group local-forms">
                            <label for="paidToSupplierPurchaseCost">Purchase Cost<span
                                class="login-danger">*</span></label>
                            <div class="input-group">
                              <input class="form-control" type="number" placeholder="Enter Square Feet"
                                formControlName="paidToSupplierPurchaseCost" (change)="calculateTotalAmount()" />
                            </div>
                            <div *ngIf="
                                      addNewPurchaseForm.get('paidToSupplierPurchaseCost')?.hasError('min') &&
                                      addNewPurchaseForm.get('paidToSupplierPurchaseCost')?.touched
                                    ">
                              <span class="login-danger">Input must be at least 0.
                              </span>
                            </div>
                            <div *ngIf="
                                      addNewPurchaseForm.get('paidToSupplierPurchaseCost')?.hasError('required') &&
                                      addNewPurchaseForm.get('paidToSupplierPurchaseCost')?.touched
                                    ">
                              <span class="login-danger">Field is required.
                              </span>
                            </div>
                          </div>
                        </div>

                        <div class="col-12 col-md-4 col-xl-4">
                          <div class="form-group local-forms">
                            <label for="totalSQFT">Square Feet<span class="login-danger">*</span></label>
                            <div class="input-group">
                              <input class="form-control" type="number" placeholder="Enter Square Feet"
                                formControlName="totalSQFT" (change)="calculateTotalAmount()" />
                            </div>
                            <div *ngIf="
                                    (addNewPurchaseForm
                                    .get('totalSQFT')
                                    ?.hasError('min') &&
                                    addNewPurchaseForm.get('totalSQFT')
                                        ?.touched) ||
                                    (addNewPurchaseForm
                                    .get('totalSQFT')
                                    ?.hasError('max') &&
                                    addNewPurchaseForm.get('totalSQFT')?.touched)
                                ">
                              <span class="login-danger">
                                input must be between 1 and 100,0000.
                              </span>
                            </div>
                          </div>
                        </div>

                        <div class="col-12 col-md-4 col-xl-4">
                          <div class="form-group local-forms">
                            <label for="width">Width<span class="login-danger"></span></label>
                            <div class="input-group">
                              <div class="input-group-prepend">
                                <span class="input-group-text" style="font-size: 12px;">Inch</span>
                              </div>
                              <input class="form-control" type="number" placeholder="Enter Width"
                                formControlName="width" />
                            </div>

                            <div *ngIf="
                                            (addNewPurchaseForm
                                            .get('width')
                                            ?.hasError('min') &&
                                            addNewPurchaseForm.get('width')
                                                ?.touched) ||
                                            (addNewPurchaseForm
                                            .get('width')
                                            ?.hasError('max') &&
                                            addNewPurchaseForm.get('width')?.touched)
                                        ">
                              <span class="login-danger">
                                input must be between 1 and 100,000.
                              </span>
                            </div>
                          </div>
                        </div>

                        <div class="col-12 col-md-4 col-xl-4">
                          <div class="form-group local-forms">
                            <label for="length">Length<span class="login-danger"></span></label>
                            <div class="input-group">
                              <div class="input-group-prepend">
                                <span class="input-group-text" style="font-size: 12px;">Inch</span>
                              </div>
                              <input class="form-control" type="number" placeholder="Enter Length"
                                formControlName="length" />
                            </div>

                            <div *ngIf="
                                            (addNewPurchaseForm
                                            .get('length')
                                            ?.hasError('min') &&
                                            addNewPurchaseForm.get('length')
                                                ?.touched) ||
                                            (addNewPurchaseForm
                                            .get('length')
                                            ?.hasError('max') &&
                                            addNewPurchaseForm.get('length')?.touched)
                                        ">
                              <span class="login-danger">
                                input must be between 1 and 100,000.
                              </span>
                            </div>
                          </div>
                        </div>

                        <div class="col-12 col-md-4 col-xl-4">
                          <div class="form-group local-forms">
                            <label for="thickness">Thickness(mm)<span class="login-danger"></span></label>
                            <input class="form-control" type="number" placeholder="Enter Thickness"
                              formControlName="thickness" />

                            <div *ngIf="
                              (addNewPurchaseForm
                              .get('thickness')
                              ?.hasError('min') &&
                              addNewPurchaseForm.get('thickness')
                                  ?.touched) ||
                              (addNewPurchaseForm
                              .get('thickness')
                              ?.hasError('max') &&
                              addNewPurchaseForm.get('thickness')?.touched)
                          ">
                              <span class="login-danger">
                                input must be between 1 and 100,000.
                              </span>
                            </div>
                          </div>
                        </div>

                        <div class="col-12 col-md-4 col-xl-4">
                          <div class="form-group local-forms">
                            <label for="subCategory">Finishes<span class="login-danger">*</span></label>
                            <p-dropdown [options]="finishes" styleClass="" appendTo="body" placeholder="Select finishes"
                              optionLabel="name" formControlName="finishes" [style]="{ width: '100%' }" [filter]="true"
                              filterBy="name" [showClear]="true">
                            </p-dropdown>
                            <div *ngIf="
                                  addNewPurchaseForm
                                    .get('finishes')
                                    ?.hasError('required') &&
                                  addNewPurchaseForm.get('finishes')?.touched
                                ">
                              <span class="login-danger">Field is required.</span>
                            </div>
                          </div>
                        </div>

                        <div class="col-12 col-md-4 col-xl-4">
                          <div class="form-group local-forms">
                            <label for="totalSqrFt">Selling Price / Sq Ft<span class="login-danger"></span></label>

                            <div class="input-group">
                              <div class="input-group-prepend">
                                <span class="input-group-text">₹</span>
                              </div>
                              <input class="form-control" type="number" placeholder="Enter Selling Price"
                                formControlName="sellingPricePerSQFT" />

                            </div>
                            <div *ngIf="
                                    addNewPurchaseForm
                                    .get('sellingPricePerSQFT')
                                    ?.hasError('required') &&
                                    addNewPurchaseForm.get('sellingPricePerSQFT')?.touched
                                ">
                              <span class="login-danger">Field is required.</span>
                            </div>
                            <div *ngIf="
                                    (addNewPurchaseForm
                                    .get('sellingPricePerSQFT')
                                    ?.hasError('min') &&
                                    addNewPurchaseForm.get('sellingPricePerSQFT')?.touched) ||
                                    (addNewPurchaseForm
                                    .get('sellingPricePerSQFT')
                                    ?.hasError('max') &&
                                    addNewPurchaseForm.get('sellingPricePerSQFT')?.touched)
                                ">
                              <span class="login-danger">
                                input must be between 1 and 100,000.
                              </span>
                            </div>
                          </div>
                        </div>

                      </div>
                      <div class="invoice-total-footer">
                        <h4>
                          Total Costing
                          <span>
                            {{
                            addNewPurchaseForm.get("slabTotalCosthing")?.value
                            ? '₹ ' + (addNewPurchaseForm.get("slabTotalCosthing").value | number: "1.2-2")
                            : null
                            }}
                          </span>

                        </h4>
                      </div>
                    </div>
                    <div class="d-flex pt-4 justify-content-between">
                      <button class="btn btn-primary" (click)="prevCallback.emit()">
                        <i class="fa-solid fa-arrow-left"></i> Back
                      </button>
                      <button class="btn btn-primary" (click)="nextStep(nextCallback)">
                        Next <i class="fa-solid fa-arrow-right"></i>
                      </button>
                    </div>
                  </ng-template>
                </p-stepperPanel>
                <p-stepperPanel header="Summary">
                  <ng-template pTemplate="content" let-prevCallback="prevCallback" let-nextCallback="nextCallback"
                    let-index="index">
                    <!-- ---------------To Show Information--------------------------- -->
                    <div class="card">
                      <div class="card-body">
                        <h3>Purchase Information</h3>
                        <div class="row practice-card">
                          <div class="col-xl-6 col-lg-6 col-sm-6">
                            <div class="form-group row mb-2">
                              <h5 class="col-lg-6 col-md-6 col-xl-6 col-form-label heading-bold">
                                Invoice Number
                              </h5>
                              <div class="col-lg-6 col-md-6 col-xl-6">
                                <p class="col-lg-6 col-form-label heading-bold">
                                  {{ addNewPurchaseForm.get("invoiceNumber").value }}
                                </p>
                              </div>
                            </div>
                          </div>
                          <div class="col-xl-6 col-lg-6 col-sm-6">
                            <div class="form-group row mb-2">
                              <h5 class="col-lg-6 col-md-6 col-xl-6 col-form-label heading-bold">
                                Purchase Date
                              </h5>
                              <div class="col-lg-6 col-md-6 col-xl-6">
                                <p class="col-lg-6 col-form-label heading-bold">
                                  {{ addNewPurchaseForm.get("purchaseDate").value }}
                                </p>
                              </div>
                            </div>
                          </div>
                          <div class="col-xl-6 col-lg-6 col-sm-6">
                            <div class="form-group row mb-2">
                              <h5 class="col-lg-6 col-md-6 col-xl-6 col-form-label heading-bold">
                                Supplier
                              </h5>
                              <div class="col-lg-6 col-md-6 col-xl-6">
                                <p class="col-lg-6 col-form-label heading-bold">
                                  {{ addNewPurchaseForm.get("supplier").value.name }}
                                </p>
                              </div>
                            </div>
                          </div>
                          <div class="col-xl-6 col-lg-6 col-sm-6">
                            <div class="form-group row mb-2">
                              <h5 class="col-lg-6 col-md-6 col-xl-6 col-form-label heading-bold">
                                Supplier
                              </h5>
                              <div class="col-lg-6 col-md-6 col-xl-6">
                                <p class="col-lg-6 col-form-label heading-bold">
                                  {{ addNewPurchaseForm.get("supplier").value.name }}
                                </p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="card" *ngIf="lotTypeValue === 'Lot'">
                      <div class="card-body">
                        <h3>{{addNewPurchaseForm.get("purchaseType").value }} Information</h3>
                        <div class="row practice-card" *ngIf="ItemDetails">
                          <div class="col-xl-6 col-lg-6 col-sm-6">
                            <div class="form-group row mb-2">
                              <h5 class="col-lg-6 col-md-6 col-xl-6 col-form-label heading-bold">
                                Lot Number
                              </h5>
                              <div class="col-lg-6 col-md-6 col-xl-6">
                                <p class="col-lg-6 col-form-label heading-bold">
                                  {{ ItemDetails.lotNo }}
                                </p>
                              </div>
                            </div>
                          </div>
                          <div class="col-xl-6 col-lg-6 col-sm-6">
                            <div class="form-group row mb-2">
                              <h5 class="col-lg-6 col-md-6 col-xl-6 col-form-label heading-bold">
                                Lot Name
                              </h5>
                              <div class="col-lg-6 col-md-6 col-xl-6">
                                <p class="col-lg-6 col-form-label heading-bold">
                                  {{ ItemDetails.lotName }}
                                </p>
                              </div>
                            </div>
                          </div>
                          <div class="col-xl-6 col-lg-6 col-sm-6">
                            <div class="form-group row mb-2">
                              <h5 class="col-lg-6 col-md-6 col-xl-6 col-form-label heading-bold">
                                Vehicle Number
                              </h5>
                              <div class="col-lg-6 col-md-6 col-xl-6">
                                <p class="col-lg-6 col-form-label heading-bold">
                                  {{ ItemDetails.vehicleNo }}
                                </p>
                              </div>
                            </div>
                          </div>
                          <div class="col-xl-6 col-lg-6 col-sm-6">
                            <div class="form-group row mb-2">
                              <h5 class="col-lg-6 col-md-6 col-xl-6 col-form-label heading-bold">
                                Lot Weight (Ton)
                              </h5>
                              <div class="col-lg-6 col-md-6 col-xl-6">
                                <p class="col-lg-6 col-form-label heading-bold">
                                  {{ ItemDetails.lotWeight }}
                                </p>
                              </div>
                            </div>
                          </div>
                          <div class="col-xl-6 col-lg-6 col-sm-6">
                            <div class="form-group row mb-2">
                              <h5 class="col-lg-6 col-md-6 col-xl-6 col-form-label heading-bold">
                                Price / Ton
                              </h5>
                              <div class="col-lg-6 col-md-6 col-xl-6">
                                <p class="col-lg-6 col-form-label heading-bold">
                                  {{ ItemDetails.pricePerTon }}
                                </p>
                              </div>
                            </div>
                          </div>
                          <div class="col-xl-6 col-lg-6 col-sm-6">
                            <div class="form-group row mb-2">
                              <h5 class="col-lg-6 col-md-6 col-xl-6 col-form-label heading-bold">
                                Transportation Charge
                              </h5>
                              <div class="col-lg-6 col-md-6 col-xl-6">
                                <p class="col-lg-6 col-form-label heading-bold">
                                  {{ ItemDetails.transportationCharge }}
                                </p>
                              </div>
                            </div>
                          </div>
                          <div class="col-xl-6 col-lg-6 col-sm-6">
                            <div class="form-group row mb-2">
                              <h5 class="col-lg-6 col-md-6 col-xl-6 col-form-label heading-bold">
                                Royalty ( Other Charge )
                              </h5>
                              <div class="col-lg-6 col-md-6 col-xl-6">
                                <p class="col-lg-6 col-form-label heading-bold">
                                  {{ ItemDetails.royaltyCharge }}
                                </p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- ---------------------block-------------- -->
                      <div class="row p-2" *ngIf="ItemDetails.blockDetails.length > 0" >
                        <div class="col-sm-12">
                          <div class="card-body" style="border-top: 1px solid rgb(189 189 189);">
                            <!-- <div class="card-body"> -->
                              <div class="page-table-header mb-2">
                                <div class="d-flex m-b-10" style="justify-content: space-between">
                                  <h3>Block List</h3>
                                </div>

                                <div class="row practice-card">
                                  <div class="col-xl-6 col-lg-6 col-sm-6">
                                    <div class="form-group row mb-2">
                                      <h5 class="col-lg-6 col-md-6 col-xl-6 col-form-label heading-bold">
                                        Average Weight
                                      </h5>
                                      <div class="col-lg-6 col-md-6 col-xl-6">
                                        <p class="col-lg-6 col-form-label heading-bold">
                                          {{ ItemDetails.averageWeight.toFixed(3) }}
                                        </p>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-xl-6 col-lg-6 col-sm-6">
                                    <div class="form-group row mb-2">
                                      <h5 class="col-lg-6 col-md-6 col-xl-6 col-form-label heading-bold">
                                        Transportation Charge / Ton
                                      </h5>
                                      <div class="col-lg-6 col-md-6 col-xl-6">
                                        <p class="col-lg-6 col-form-label heading-bold">
                                          ₹
                                          {{
                                          ItemDetails.averageTransport.toFixed(3)
                                          }}
                                        </p>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-xl-6 col-lg-6 col-sm-6">
                                    <div class="form-group row mb-2">
                                      <h5 class="col-lg-6 col-md-6 col-xl-6 col-form-label heading-bold">
                                        Royalty Charge / Ton
                                      </h5>
                                      <div class="col-lg-6 col-md-6 col-xl-6">
                                        <p class="col-lg-6 col-form-label heading-bold">
                                          ₹
                                          {{ ItemDetails.averageRoyalty.toFixed(3) }}
                                        </p>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>

                              <div class="row p-2">
                                <p-accordion [activeIndex]="0">
                                  <p-accordionTab *ngFor="let data of ItemDetails.blockDetails; let i = index">
                                    <ng-template pTemplate="header">
                                      <span class="d-flex justify-content-between w-full">
                                        <span class="font-bold white-space-nowrap">
                                          Block No: {{ data.blockNo }} ({{
                                          data.weightPerBlock.toFixed(3)
                                          }}
                                          Ton)
                                        </span>
                                      </span>
                                    </ng-template>
                                    <div class="row">
                                      <div class="col-sm-12">
                                        <div class="card card-table show-entire">
                                          <div class="page-table-header mb-2 m-3">
                                            <div class="row practice-card">
                                              <div class="col-xl-6 col-lg-6 col-sm-12">
                                                <div class="form-group row mb-2">
                                                  <h5 class="col-lg-3 col-md-3 col-xl-3 col-form-label">
                                                    Height (Inch)
                                                  </h5>
                                                  <div class="col-lg-9 col-md-9 col-xl-9">
                                                    <p class="col-lg-9 col-form-label">
                                                      {{ data.height }}
                                                    </p>
                                                  </div>
                                                </div>
                                                <div class="form-group row mb-2">
                                                  <h5 class="col-lg-3 col-md-3 col-xl-3 col-form-label">
                                                    Width (Inch)
                                                  </h5>
                                                  <div class="col-lg-9 col-md-9 col-xl-9">
                                                    <p class="col-form-label">{{ data.width }}</p>
                                                  </div>
                                                </div>
                                                <div class="form-group row mb-2">
                                                  <h5 class="col-lg-3 col-md-3 col-xl-3 col-form-label">
                                                    Length (Inch)
                                                  </h5>
                                                  <div class="col-lg-9 col-md-9 col-xl-9">
                                                    <p class="col-form-label">
                                                      {{ data.length }}
                                                    </p>
                                                  </div>
                                                </div>
                                                <div class="form-group row mb-2">
                                                  <h5 class="col-lg-3 col-md-3 col-xl-3 col-form-label">
                                                    Total Area (Inch)
                                                  </h5>
                                                  <div class="col-lg-9 col-md-9 col-xl-9">
                                                    <p class="col-form-label">
                                                      {{ data.totalArea }}
                                                    </p>
                                                  </div>
                                                </div>
                                                <div class="form-group row mb-2">
                                                  <h5 class="col-lg-3 col-md-3 col-xl-3 col-form-label">
                                                    Weigth (Ton)
                                                  </h5>
                                                  <div class="col-lg-9 col-md-9 col-xl-9">
                                                    <p class="col-form-label">
                                                      {{ data.weightPerBlock.toFixed(3) }}
                                                    </p>
                                                  </div>
                                                </div>
                                              </div>
                                              <div class="col-xl-6 col-lg-6 col-sm-12">
                                                <div class="form-group row mb-2">
                                                  <h5 class="col-lg-3 col-md-3 col-xl-3 col-form-label">
                                                    Raw Costing
                                                  </h5>
                                                  <div class="col-lg-9 col-md-9 col-xl-9">
                                                    <p class="col-form-label">
                                                      ₹ {{ data.rawCosting.toFixed(3) }}
                                                    </p>
                                                  </div>
                                                </div>
                                                <div class="form-group row mb-2">
                                                  <h5 class="col-lg-3 col-md-3 col-xl-3 col-form-label">
                                                    Transportation
                                                  </h5>
                                                  <div class="col-lg-9 col-md-9 col-xl-9">
                                                    <p class="col-form-label">
                                                      ₹
                                                      {{ data.transportationCosting.toFixed(3) }}
                                                    </p>
                                                  </div>
                                                </div>
                                                <div class="form-group row mb-2">
                                                  <h5 class="col-lg-3 col-md-3 col-xl-3 col-form-label">
                                                    Royalty
                                                  </h5>
                                                  <div class="col-lg-9 col-md-9 col-xl-9">
                                                    <p class="col-form-label">
                                                      ₹
                                                      {{ data.royaltyCosting.toFixed(3) }}
                                                    </p>
                                                  </div>
                                                </div>
                                                <div class="form-group row mb-2">
                                                  <h5 class="col-lg-3 col-md-3 col-xl-3 col-form-label">
                                                    Total Costing
                                                  </h5>
                                                  <div class="col-lg-9 col-md-9 col-xl-9">
                                                    <p class="col-form-label">
                                                      ₹ {{ data.totalCosting.toFixed(3) }}
                                                    </p>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </p-accordionTab>
                                </p-accordion>
                              </div>
                            <!-- </div> -->
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="row">
                      <div class="col-lg-7 col-md-6">

                        <div class="invoice-fields">
                          <h4 class="field-title">More Fields</h4>

                      </div>
                      <div class="invoice-faq">
                          <div class="panel-group" id="accordion" role="tablist"
                              aria-multiselectable="true">
                              <div class="faq-tab">
                                  <div class="panel panel-default">
                                      <div class="panel-heading" role="tab" id="headingThree">
                                          <p class="panel-title">
                                              <a class="collapsed" data-bs-toggle="collapse"
                                                  data-bs-parent="#accordion" href="#collapseThree"
                                                  aria-expanded="false" aria-controls="collapseThree">
                                                  <i class="fas fa-plus-circle me-1"></i> Add Notes
                                              </a>
                                          </p>
                                      </div>
                                      <div id="collapseThree" class="panel-collapse collapse"
                                          role="tabpanel" aria-labelledby="headingThree"
                                          data-bs-parent="#accordion">
                                          <div class="panel-body">
                                              <textarea class="form-control"
                                                  formControlName="purchaseNotes"></textarea>
                                              <!-- <div
                                                  *ngIf="addSalesForm.get('purchaseNotes')?.hasError('pattern')  && addSalesForm.get('purchaseNotes')?.touched">
                                                  <span class="login-danger">Input must be between 2 to
                                                      100 characters.</span>
                                              </div> -->
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                      </div>
                      <div class="col-lg-5 col-md-6">
                        <div class="invoice-total-card">
                          <h4 class="invoice-total-title">Summary</h4>
                          <div class="invoice-total-box">
                            <div class="invoice-total-inner" *ngIf="lotTypeValue === 'Lot'">
                              <p *ngIf="ItemDetails.lotWeight">
                                Lot Weight ( Ton )<span>
                                  {{ItemDetails.lotWeight === undefined ? '' : ItemDetails.lotWeight}}
                                </span>
                              </p>
                              <p *ngIf="ItemDetails.pricePerTon">
                                Price Per Ton<span>
                                  {{ItemDetails.pricePerTon === undefined ? '' : '₹' + ItemDetails.pricePerTon}}
                                </span>
                              </p>
                              <p *ngIf="ItemDetails.transportationCharge">
                                Transport Charges<span>
                                  {{ItemDetails.transportationCharge === undefined ? '' : '₹' + ' ' +
                                  ItemDetails.transportationCharge}}
                                </span>
                              </p>
                              <p *ngIf="ItemDetails.royaltyCharge">
                                Royalty Charges<span>
                                  {{ItemDetails.royaltyCharge === undefined ? '' : '₹' + ' ' +
                                  ItemDetails.royaltyCharge}}
                                </span>
                              </p>
                              <p>
                                Purchase Cost ( Paid To Supplier)
                                <span>
                                  {{
                                  addNewPurchaseForm.get("paidToSupplierPurchaseCost")?.value
                                  ? '₹ ' + (addNewPurchaseForm.get("paidToSupplierPurchaseCost").value | number:
                                  "1.2-2")
                                  : null
                                  }}
                                </span>
                              </p>
                            </div>
                            <!-- ---------------slab--------------------------- -->
                            <!-- <div class="invoice-total-inner">
                              <p *ngIf="lotTypeValue === 'slab'">
                                Per Square Feet Cost<span>
                                  {{
                                  addNewPurchaseForm.get("sellingPricePerSQFT")?.value
                                  ? '₹ ' + (addNewPurchaseForm.get("sellingPricePerSQFT").value | number: "1.2-2")
                                  : null
                                  }}
                                </span>
                              </p>
                              <p>
                                Processing Costing<span>
                                  {{
                                  addNewPurchaseForm.get("paidToSupplier")?.value ? '₹ ' +
                                  (addNewPurchaseForm.get("paidToSupplier").value |
                                  number: "1.2-2") : null
                                  }}
                                </span>
                              </p>
                              <p>
                                Transport Charges<span>
                                  {{
                                  addNewPurchaseForm.get("transportationCharges")?.value
                                  ? '₹ ' + (addNewPurchaseForm.get("transportationCharges").value | number: "1.2-2")
                                  : null
                                  }}
                                </span>
                              </p>
                              <p>
                                Other Charges<span>
                                  {{
                                  addNewPurchaseForm.get("otherCharges")?.value
                                  ? '₹ ' + (addNewPurchaseForm.get("otherCharges").value | number: "1.2-2")
                                  : null
                                  }}
                                </span>
                              </p>
                              <p>
                                Port Expenses<span>
                                  {{
                                  addNewPurchaseForm.get("portExpenses")?.value
                                  ? '₹ ' + (addNewPurchaseForm.get("portExpenses").value | number: "1.2-2")
                                  : null
                                  }}
                                </span>
                              </p>
                            </div> -->

                            <div class="invoice-total-footer" *ngIf="lotTypeValue === 'Lot'">
                              <h4>
                                Total Purchase Cost.
                                <span>{{ItemDetails.lotTotalCost === undefined ? '' : '₹' + ' ' +
                                  ItemDetails.lotTotalCost.toFixed(3)}}
                                </span>
                              </h4>
                            </div>
                            <div class="invoice-total-footer" *ngIf="lotTypeValue === 'Slab'">
                              <h4>
                                Total Purchase Cost.
                                <span>
                                  {{
                                  addNewPurchaseForm.get("slabTotalCosthing")?.value
                                  ? '₹ ' + (addNewPurchaseForm.get("slabTotalCosthing").value | number: "1.2-2")
                                  : null
                                  }}
                                </span>
                              </h4>
                            </div>
                          </div>
                        </div>
                        <!-- <div class="upload-sign">
                          <div class="settings-btns text-end m-b-10 row">
                            <div class="col-md-12 col-sm-12 col-lg-6 col-xl-6">
                              <button type="submit" class="border-0 btn btn-primary btn-gradient-primary">
                                Submit
                              </button>
                            </div>
                            <div class="col-md-12 col-sm-12 col-xl-6 col-lg-6">
                              <button class="btn btn-secondary m10" >
                                Cancel
                              </button>
                            </div>
                          </div>
                        </div> -->
                      </div>
                    </div>
                    <div class="d-flex pt-4 justify-content-between">
                      <button class="btn btn-primary" (click)="prevCallback.emit()">
                        <i class="fa-solid fa-arrow-left"></i> Back
                      </button>
                      <button type="submit" class="border-0 btn btn-primary btn-gradient-primary">
                        Submit 
                      </button>
                    </div>
                  </ng-template>
                </p-stepperPanel>
              </p-stepper>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>